<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>binary classification using the ionosphere data • KernelKnn</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="binary classification using the ionosphere data">
<meta property="og:description" content="KernelKnn">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">KernelKnn</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/binary_classification_using_the_ionosphere_data.html">binary classification using the ionosphere data</a>
    </li>
    <li>
      <a href="../articles/image_classification_using_MNIST_CIFAR_data.html">Image classification of the MNIST and CIFAR-10 data using KernelKnn and HOG (histogram of oriented gradients)</a>
    </li>
    <li>
      <a href="../articles/regression_using_the_housing_data.html">Regression using the Housing data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mlampros/KernelKnn/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="binary_classification_using_the_ionosphere_data_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>binary classification using the ionosphere data</h1>
                        <h4 class="author">Lampros Mouselimis</h4>
            
            <h4 class="date">2021-09-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mlampros/KernelKnn/blob/master/vignettes/binary_classification_using_the_ionosphere_data.Rmd"><code>vignettes/binary_classification_using_the_ionosphere_data.Rmd</code></a></small>
      <div class="hidden name"><code>binary_classification_using_the_ionosphere_data.Rmd</code></div>

    </div>

    
    
<p>The following examples illustrate the functionality of the KernelKnn package for <strong>classification</strong> tasks. I’ll make use of the <em>ionosphere</em> data set,</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">ionosphere</span>, package <span class="op">=</span> <span class="st">'KernelKnn'</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">ionosphere</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##    V1    V2    V3    V4    V5    V6    V7    V8    V9   V10   V11   V12   V13 
##     2     1   219   269   204   259   231   260   244   267   246   269   238 
##   V14   V15   V16   V17   V18   V19   V20   V21   V22   V23   V24   V25   V26 
##   266   234   270   254   280   254   266   248   265   248   264   256   273 
##   V27   V28   V29   V30   V31   V32   V33   V34 class 
##   256   281   244   266   243   263   245   263     2</code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># the second column will be removed as it has a single unique value</span>

<span class="va">ionosphere</span> <span class="op">=</span> <span class="va">ionosphere</span><span class="op">[</span>, <span class="op">-</span><span class="fl">2</span><span class="op">]</span></code></pre></div>
<p><br></p>
<p>When using an algorithm where the ouput depends on distance calculation (as is the case in k-nearest-neighbors) it is recommended to first scale the data,</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># recommended is to scale the data</span>

<span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">ionosphere</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">ionosphere</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="va">y</span> <span class="op">=</span> <span class="va">ionosphere</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">ionosphere</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<p><br></p>
<p><strong>important note</strong> : In classification, both functions <em>KernelKnn</em> and <em>KernelKnnCV</em> accept a numeric vector as a response variable (here y) and the unique values of the labels should begin from 1. This is important otherwise the internal functions do not work. Furthermore, both functions (by default) return predictions in form of probabilities, which can be converted to labels by using either a threshold (if binary classification) or the maximum value of each column (if multiclass classification).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># labels should be numeric and begin from 1:Inf</span>

<span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="va">ionosphere</span><span class="op">$</span><span class="va">class</span>, <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">ionosphere</span><span class="op">$</span><span class="va">class</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">]</span>

<span class="co"># random split of data in train and test</span>

<span class="va">spl_train</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.75</span><span class="op">)</span><span class="op">)</span>
<span class="va">spl_test</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html">setdiff</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, <span class="va">spl_train</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">spl_train</span><span class="op">)</span></code></pre></div>
<pre><code>##  int [1:263] 94 303 35 127 171 339 83 251 343 321 ...</code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">spl_test</span><span class="op">)</span></code></pre></div>
<pre><code>##  int [1:88] 2 13 18 20 23 30 31 36 45 52 ...</code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># evaluation metric</span>

<span class="va">acc</span> <span class="op">=</span> <span class="kw">function</span> <span class="op">(</span><span class="va">y_true</span>, <span class="va">preds</span><span class="op">)</span> <span class="op">{</span>
  
  <span class="va">out</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">y_true</span>, <span class="fu"><a href="https://rdrr.io/r/base/maxCol.html">max.col</a></span><span class="op">(</span><span class="va">preds</span>, ties.method <span class="op">=</span> <span class="st">"random"</span><span class="op">)</span><span class="op">)</span>
  
  <span class="va">acc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span>
  
  <span class="va">acc</span>
<span class="op">}</span></code></pre></div>
<div id="the-kernelknn-function" class="section level2">
<h2 class="hasAnchor">
<a href="#the-kernelknn-function" class="anchor"></a>The KernelKnn function</h2>
<p>The KernelKnn function takes a number of arguments. To read details for each one of the arguments type ?KernelKnn::KernelKnn in the console.</p>
<p>A simple k-nearest-neighbors can be run with weights_function = NULL and the parameter ‘regression’ should be set to FALSE. In classification the <em>Levels</em> parameter takes the unique values of the response variable,</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mlampros/KernelKnn">KernelKnn</a></span><span class="op">)</span>

<span class="va">preds_TEST</span> <span class="op">=</span> <span class="fu"><a href="../reference/KernelKnn.html">KernelKnn</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span><span class="va">spl_train</span>, <span class="op">]</span>, TEST_data <span class="op">=</span> <span class="va">X</span><span class="op">[</span><span class="va">spl_test</span>, <span class="op">]</span>, <span class="va">y</span><span class="op">[</span><span class="va">spl_train</span><span class="op">]</span>, k <span class="op">=</span> <span class="fl">5</span> , 
                       
                       method <span class="op">=</span> <span class="st">'euclidean'</span>, weights_function <span class="op">=</span> <span class="cn">NULL</span>, regression <span class="op">=</span> <span class="cn">F</span>,
                       
                       Levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">preds_TEST</span><span class="op">)</span></code></pre></div>
<pre><code>##      class_1 class_2
## [1,]     0.0     1.0
## [2,]     0.0     1.0
## [3,]     1.0     0.0
## [4,]     0.2     0.8
## [5,]     0.0     1.0
## [6,]     1.0     0.0</code></pre>
<p><br> There are two ways to use a kernel in the KernelKnn function. The <strong>first option</strong> is to choose one of the existing kernels (<em>uniform</em>, <em>triangular</em>, <em>epanechnikov</em>, <em>biweight</em>, <em>triweight</em>, <em>tricube</em>, <em>gaussian</em>, <em>cosine</em>, <em>logistic</em>, <em>silverman</em>, <em>inverse</em>, <em>gaussianSimple</em>, <em>exponential</em>). Here, I use the <em>canberra</em> metric and the <em>tricube</em> kernel because they give optimal results (according to my RandomSearchR package),</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">preds_TEST_tric</span> <span class="op">=</span> <span class="fu"><a href="../reference/KernelKnn.html">KernelKnn</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span><span class="va">spl_train</span>, <span class="op">]</span>, TEST_data <span class="op">=</span> <span class="va">X</span><span class="op">[</span><span class="va">spl_test</span>, <span class="op">]</span>, <span class="va">y</span><span class="op">[</span><span class="va">spl_train</span><span class="op">]</span>, k <span class="op">=</span> <span class="fl">10</span> , 
                            
                            method <span class="op">=</span> <span class="st">'canberra'</span>, weights_function <span class="op">=</span> <span class="st">'tricube'</span>, regression <span class="op">=</span> <span class="cn">F</span>,  
                            
                            Levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">preds_TEST_tric</span><span class="op">)</span></code></pre></div>
<pre><code>##              [,1]         [,2]
## [1,] 6.544320e-05 9.999346e-01
## [2,] 6.177656e-18 1.000000e+00
## [3,] 8.862466e-01 1.137534e-01
## [4,] 7.790877e-01 2.209123e-01
## [5,] 0.000000e+00 1.000000e+00
## [6,] 1.000000e+00 7.424767e-18</code></pre>
<p><br> The <strong>second option</strong> is to give a self defined kernel function. Here, I’ll pick the density function of the normal distribution with mean = 0.0 and standard deviation = 1.0 (the data are scaled to have mean zero and unit variance),</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">norm_kernel</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">W</span><span class="op">)</span> <span class="op">{</span>
  
  <span class="va">W</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">W</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1.0</span><span class="op">)</span>
  
  <span class="va">W</span> <span class="op">=</span> <span class="va">W</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">W</span><span class="op">)</span>
  
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">W</span><span class="op">)</span>
<span class="op">}</span>


<span class="va">preds_TEST_norm</span> <span class="op">=</span> <span class="fu"><a href="../reference/KernelKnn.html">KernelKnn</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span><span class="va">spl_train</span>, <span class="op">]</span>, TEST_data <span class="op">=</span> <span class="va">X</span><span class="op">[</span><span class="va">spl_test</span>, <span class="op">]</span>, <span class="va">y</span><span class="op">[</span><span class="va">spl_train</span><span class="op">]</span>, k <span class="op">=</span> <span class="fl">10</span> , 
                            
                            method <span class="op">=</span> <span class="st">'canberra'</span>, weights_function <span class="op">=</span> <span class="va">norm_kernel</span>, regression <span class="op">=</span> <span class="cn">F</span>, 
                            
                            Levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">preds_TEST_norm</span><span class="op">)</span></code></pre></div>
<pre><code>##           [,1]       [,2]
## [1,] 0.2425483 0.75745173
## [2,] 0.0757150 0.92428500
## [3,] 0.8959404 0.10405961
## [4,] 0.7951592 0.20484076
## [5,] 0.0000000 1.00000000
## [6,] 0.9220471 0.07795291</code></pre>
<p><br></p>
<p>The computations can be speed up by using the parameter <strong>threads</strong> (multiple cores can be run in parallel). There is also the option to exclude <strong>extrema</strong> (minimum and maximum distances) during the calculation of the k-nearest-neighbor distances using extrema = TRUE. The <em>bandwidth</em> of the existing kernels can be tuned using the <strong>h</strong> parameter. <br></p>
<p>K-nearest-neigbor calculations in the KernelKnn function can be accomplished using the following distance metrics : <em>euclidean</em>, <em>manhattan</em>, <em>chebyshev</em>, <em>canberra</em>, <em>braycurtis</em>, <em>minkowski</em> (by default the order ‘p’ of the minkowski parameter equals k), <em>hamming</em>, <em>mahalanobis</em>, <em>pearson_correlation</em>, <em>simple_matching_coefficient</em>, <em>jaccard_coefficient</em> and <em>Rao_coefficient</em>. The last four are similarity measures and are appropriate for binary data [0,1]. <br></p>
<p>I employed my RandomSearchR package to find the optimal parameters for the KernelKnn function and the following two pairs of parameters give an optimal accuracy, <br><br></p>
<table class="table">
<thead><tr class="header">
<th align="right">k</th>
<th align="left">method</th>
<th align="left">kernel</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">10</td>
<td align="left">canberra</td>
<td align="left">tricube</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="left">canberra</td>
<td align="left">epanechnikov</td>
</tr>
</tbody>
</table>
</div>
<div id="the-kernelknncv-function" class="section level2">
<h2 class="hasAnchor">
<a href="#the-kernelknncv-function" class="anchor"></a>The KernelKnnCV function</h2>
<p>I’ll use the <em>KernelKnnCV</em> function to calculate the accuracy using 5-fold cross-validation for the previous mentioned parameter pairs,</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_cv_pair1</span> <span class="op">=</span> <span class="fu"><a href="../reference/KernelKnnCV.html">KernelKnnCV</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, k <span class="op">=</span> <span class="fl">10</span> , folds <span class="op">=</span> <span class="fl">5</span>, method <span class="op">=</span> <span class="st">'canberra'</span>, 
                           
                           weights_function <span class="op">=</span> <span class="st">'tricube'</span>, regression <span class="op">=</span> <span class="cn">F</span>, 
                           
                           Levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, threads <span class="op">=</span> <span class="fl">5</span>, seed_num <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">fit_cv_pair1</span><span class="op">)</span></code></pre></div>
<pre><code>## List of 2
##  $ preds:List of 5
##   ..$ : num [1:71, 1:2] 0.00 5.02e-01 5.90e-18 9.16e-01 0.00 ...
##   ..$ : num [1:70, 1:2] 0 0.0846 0.2507 0.0112 1 ...
##   ..$ : num [1:70, 1:2] 0 0 0 0.056 0 ...
##   ..$ : num [1:70, 1:2] 0 0 0 0 0 0 0 0 0 0 ...
##   ..$ : num [1:70, 1:2] 0 0.986 1 1 0 ...
##  $ folds:List of 5
##   ..$ fold_1: int [1:71] 242 237 7 20 25 24 232 31 44 42 ...
##   ..$ fold_2: int [1:70] 267 59 84 75 253 269 270 50 73 257 ...
##   ..$ fold_3: int [1:70] 102 293 114 124 120 279 113 288 281 132 ...
##   ..$ fold_4: int [1:70] 142 302 160 304 321 305 172 138 325 319 ...
##   ..$ fold_5: int [1:70] 204 217 219 211 194 190 183 343 225 196 ...</code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_cv_pair2</span> <span class="op">=</span> <span class="fu"><a href="../reference/KernelKnnCV.html">KernelKnnCV</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, k <span class="op">=</span> <span class="fl">9</span> , folds <span class="op">=</span> <span class="fl">5</span>,method <span class="op">=</span> <span class="st">'canberra'</span>,
                           
                           weights_function <span class="op">=</span> <span class="st">'epanechnikov'</span>, regression <span class="op">=</span> <span class="cn">F</span>,
                           
                           Levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, threads <span class="op">=</span> <span class="fl">5</span>, seed_num <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">fit_cv_pair2</span><span class="op">)</span></code></pre></div>
<pre><code>## List of 2
##  $ preds:List of 5
##   ..$ : num [1:71, 1:2] 0 0.459 0 0.913 0 ...
##   ..$ : num [1:70, 1:2] 0.00 1.18e-01 2.01e-01 3.42e-07 1.00 ...
##   ..$ : num [1:70, 1:2] 0 0 0 0.0825 0 ...
##   ..$ : num [1:70, 1:2] 0 0 0 0 0 0 0 0 0 0 ...
##   ..$ : num [1:70, 1:2] 0 0.957 1 1 0 ...
##  $ folds:List of 5
##   ..$ fold_1: int [1:71] 242 237 7 20 25 24 232 31 44 42 ...
##   ..$ fold_2: int [1:70] 267 59 84 75 253 269 270 50 73 257 ...
##   ..$ fold_3: int [1:70] 102 293 114 124 120 279 113 288 281 132 ...
##   ..$ fold_4: int [1:70] 142 302 160 304 321 305 172 138 325 319 ...
##   ..$ fold_5: int [1:70] 204 217 219 211 194 190 183 343 225 196 ...</code></pre>
<p><br></p>
<p>Each cross-validated object returns a list of length 2 ( the first sublist includes the predictions for each fold whereas the second gives the indices of the folds)</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">acc_pair1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">fit_cv_pair1</span><span class="op">$</span><span class="va">preds</span><span class="op">)</span>, 
                          
                          <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">acc</span><span class="op">(</span><span class="va">y</span><span class="op">[</span><span class="va">fit_cv_pair1</span><span class="op">$</span><span class="va">folds</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>, 
                                          
                                          <span class="va">fit_cv_pair1</span><span class="op">$</span><span class="va">preds</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">acc_pair1</span></code></pre></div>
<pre><code>## [1] 0.9154930 0.9142857 0.9142857 0.9285714 0.9571429</code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">'accurcay for params_pair1 is :'</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">acc_pair1</span><span class="op">)</span>, <span class="st">'\n'</span><span class="op">)</span></code></pre></div>
<pre><code>## accurcay for params_pair1 is : 0.9259557</code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">acc_pair2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">fit_cv_pair2</span><span class="op">$</span><span class="va">preds</span><span class="op">)</span>, 
                          
                          <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">acc</span><span class="op">(</span><span class="va">y</span><span class="op">[</span><span class="va">fit_cv_pair2</span><span class="op">$</span><span class="va">folds</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>, 
                                          
                                          <span class="va">fit_cv_pair2</span><span class="op">$</span><span class="va">preds</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">acc_pair2</span></code></pre></div>
<pre><code>## [1] 0.9014085 0.9142857 0.9000000 0.9142857 0.9571429</code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">'accuracy for params_pair2 is :'</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">acc_pair2</span><span class="op">)</span>, <span class="st">'\n'</span><span class="op">)</span></code></pre></div>
<pre><code>## accuracy for params_pair2 is : 0.9174245</code></pre>
<p><br></p>
</div>
<div id="adding-or-multiplying-kernels" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-or-multiplying-kernels" class="anchor"></a>Adding or multiplying kernels</h2>
<p>In the KernelKnn package there is also the option to <strong>combine kernels</strong> (adding or multiplying) from the existing ones. For instance, if I want to multiply the <em>tricube</em> with the <em>gaussian</em> kernel, then I’ll give the following character string to the weights_function, <em>“tricube_gaussian_MULT”</em>. On the other hand, If I want to add the same kernels then the weights_function will be <em>“tricube_gaussian_ADD”</em>. I experimented with my RandomSearchR package combining the different kernels and the following two parameter settings gave optimal results,</p>
<p><br></p>
<table class="table">
<thead><tr class="header">
<th align="right">k</th>
<th align="left">method</th>
<th align="left">kernel</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">16</td>
<td align="left">canberra</td>
<td align="left">biweight_triweight_gaussian_MULT</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="left">canberra</td>
<td align="left">triangular_triweight_MULT</td>
</tr>
</tbody>
</table>
<p><br></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_cv_pair1</span> <span class="op">=</span> <span class="fu"><a href="../reference/KernelKnnCV.html">KernelKnnCV</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, k <span class="op">=</span> <span class="fl">16</span>, folds <span class="op">=</span> <span class="fl">5</span>, method <span class="op">=</span> <span class="st">'canberra'</span>, 
                           
                           weights_function <span class="op">=</span> <span class="st">'biweight_triweight_gaussian_MULT'</span>, 
                           
                           regression <span class="op">=</span> <span class="cn">F</span>, Levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, threads <span class="op">=</span> <span class="fl">5</span>, 
                           
                           seed_num <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">fit_cv_pair1</span><span class="op">)</span></code></pre></div>
<pre><code>## List of 2
##  $ preds:List of 5
##   ..$ : num [1:71, 1:2] 0.00 4.70e-01 5.79e-05 9.26e-01 4.85e-06 ...
##   ..$ : num [1:70, 1:2] 0 0.0476 0.2602 0.0132 0.9991 ...
##   ..$ : num [1:70, 1:2] 0.00 7.39e-08 0.00 1.78e-02 0.00 ...
##   ..$ : num [1:70, 1:2] 0 0 0 0 0 ...
##   ..$ : num [1:70, 1:2] 0 0.99181 1 1 0.00127 ...
##  $ folds:List of 5
##   ..$ fold_1: int [1:71] 242 237 7 20 25 24 232 31 44 42 ...
##   ..$ fold_2: int [1:70] 267 59 84 75 253 269 270 50 73 257 ...
##   ..$ fold_3: int [1:70] 102 293 114 124 120 279 113 288 281 132 ...
##   ..$ fold_4: int [1:70] 142 302 160 304 321 305 172 138 325 319 ...
##   ..$ fold_5: int [1:70] 204 217 219 211 194 190 183 343 225 196 ...</code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_cv_pair2</span> <span class="op">=</span> <span class="fu"><a href="../reference/KernelKnnCV.html">KernelKnnCV</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, k <span class="op">=</span> <span class="fl">5</span>, folds <span class="op">=</span> <span class="fl">5</span>, method <span class="op">=</span> <span class="st">'canberra'</span>, 
                           
                           weights_function <span class="op">=</span> <span class="st">'triangular_triweight_MULT'</span>, 
                           
                           regression <span class="op">=</span> <span class="cn">F</span>, Levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, threads <span class="op">=</span> <span class="fl">5</span>,
                           
                           seed_num <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">fit_cv_pair2</span><span class="op">)</span></code></pre></div>
<pre><code>## List of 2
##  $ preds:List of 5
##   ..$ : num [1:71, 1:2] 0 0.363 0 1 0 ...
##   ..$ : num [1:70, 1:2] 0 0.00076 0.18937 0 1 ...
##   ..$ : num [1:70, 1:2] 0.00 0.00 0.00 3.44e-24 0.00 ...
##   ..$ : num [1:70, 1:2] 0 0 0 0 0 0 0 0 0 0 ...
##   ..$ : num [1:70, 1:2] 0 1 1 1 0 ...
##  $ folds:List of 5
##   ..$ fold_1: int [1:71] 242 237 7 20 25 24 232 31 44 42 ...
##   ..$ fold_2: int [1:70] 267 59 84 75 253 269 270 50 73 257 ...
##   ..$ fold_3: int [1:70] 102 293 114 124 120 279 113 288 281 132 ...
##   ..$ fold_4: int [1:70] 142 302 160 304 321 305 172 138 325 319 ...
##   ..$ fold_5: int [1:70] 204 217 219 211 194 190 183 343 225 196 ...</code></pre>
<p><br></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">acc_pair1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">fit_cv_pair1</span><span class="op">$</span><span class="va">preds</span><span class="op">)</span>, 
                          
                          <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">acc</span><span class="op">(</span><span class="va">y</span><span class="op">[</span><span class="va">fit_cv_pair1</span><span class="op">$</span><span class="va">folds</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>, 
                                          
                                          <span class="va">fit_cv_pair1</span><span class="op">$</span><span class="va">preds</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">acc_pair1</span></code></pre></div>
<pre><code>## [1] 0.9014085 0.9142857 0.9285714 0.9285714 0.9571429</code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">'accuracy for params_pair1 is :'</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">acc_pair1</span><span class="op">)</span>, <span class="st">'\n'</span><span class="op">)</span></code></pre></div>
<pre><code>## accuracy for params_pair1 is : 0.925996</code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">acc_pair2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">fit_cv_pair2</span><span class="op">$</span><span class="va">preds</span><span class="op">)</span>, 
                          
                          <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">acc</span><span class="op">(</span><span class="va">y</span><span class="op">[</span><span class="va">fit_cv_pair2</span><span class="op">$</span><span class="va">folds</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>,
                                          
                                          <span class="va">fit_cv_pair2</span><span class="op">$</span><span class="va">preds</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">acc_pair2</span></code></pre></div>
<pre><code>## [1] 0.9014085 0.9285714 0.9285714 0.9142857 0.9714286</code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">'accuracy for params_pair2 is :'</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">acc_pair2</span><span class="op">)</span>, <span class="st">'\n'</span><span class="op">)</span></code></pre></div>
<pre><code>## accuracy for params_pair2 is : 0.9288531</code></pre>
<p><br></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Lampros Mouselimis.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
